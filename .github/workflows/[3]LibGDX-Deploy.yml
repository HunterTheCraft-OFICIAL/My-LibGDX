name: LibGDX-Deploy

on:
  workflow_run:
    workflows: ["LibGDX-Report"]
    types:
      - completed

jobs:
  deploy-libs:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}

    steps:
    - name: Download Libraries
      uses: actions/download-artifact@v4
      with:
        name: libgdx-libs
        path: libs/

    - name: Download Dependency Report
      uses: actions/download-artifact@v4
      with:
        name: libgdx-dependency-report
        path: report/

    - name: Prepare Deployment Package
      run: |
        mkdir deploy
        cp libs/* deploy/
        cp report/dependency-report.txt deploy/
        echo "Deployment package prepared with libs + report"

    - name: Upload Deployment Package
      uses: actions/upload-artifact@v4
      with:
        name: libgdx-deploy-package
        path: deploy/